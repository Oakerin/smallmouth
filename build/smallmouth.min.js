/*! smallmouth v0.0.1 */
var SmallMouth;!function(a){function b(a,c){if(!(c instanceof Object)||c instanceof String||c instanceof Number||c instanceof Array||c instanceof Boolean)a.data=c;else for(var d in c)c.hasOwnProperty(d)&&(a.children.hasOwnProperty(d)?a.children[d].version++:a.children[d]={children:{},version:0},b(a.children[d],c[d]))}function c(a,b){if(b||(b={}),""==a.trim())return i;for(var c=a.split("/"),d=i,e=0,f=c.length;f>e;e++)d.children[c[e]]||(d.children[c[e]]={children:{},version:0}),b.versionUpdate&&d.version++,d=d.children[c[e]];return d}function d(a,d){var e=c(a._path,{versionUpdate:!0});b(e,d),e.version++,f(a)}function e(a){var b=c(a._path);a.data=b.data,f(a)}function f(){h&&clearTimeout(h),h=setTimeout(function(){localStorage.setItem("LargeMouth_Registry",JSON.stringify(i))},100)}function g(){i.data=null,i.children={},i.version=0,localStorage.setItem("LargeMouth_Registry",JSON.stringify(i))}var h,i=JSON.parse(localStorage.getItem("LargeMouth_Registry"))||{data:null,children:{},version:0};a._registry={sync:f,initializeRegistry:e,updateRegistry:d,getData:c,dataRegistry:i,resetRegistry:g}}(SmallMouth||(SmallMouth={}));var SmallMouth;!function(a){var b=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(([^#]*))?(#(.*))?"),c={},d=function(){function d(d){this._callbacks=[];var e=b.exec(d),f=e[1],g=e[3],h=e[5],i=e[6],j=(f?f:"")+(g?g:""),k=this.cleanPath((h?h:"")+(i?i:"")),l=c[j];this._path=k,this._host=j,this._socket=l?l:l=c[j]=io.connect(j),a._registry.initializeRegistry(this)}return d.prototype.on=function(a,b,c,d){return this._callbacks.push({type:a,callback:function(){return b.call(d,null)}}),this},d.prototype.set=function(b){return a._registry.updateRegistry(this,b),this},d.prototype.update=function(){return this},d.prototype.child=function(a){return new d(this._host+"/"+this._path+"/"+this.cleanPath(a))},d.prototype.parent=function(){return new d(this._host+"/"+this._path.substring(0,this._path.lastIndexOf("/")))},d.prototype.root=function(){return new d(this._host+"/"+this._path.substring(0,this._path.indexOf("/")))},d.prototype.name=function(){return this._path.substring(this._path.lastIndexOf("/")+1)},d.prototype.toString=function(){return this._path},d.prototype.cleanPath=function(a){return a="/"===a.charAt(0)?a.substring(1):a,a="/"===a.charAt(a.length-1)?a.substring(0,a.length-1):a},d.prototype._getSnapshot=function(){return a._registry.getData(this._path)},d}();a.Resource=d}(SmallMouth||(SmallMouth={}));